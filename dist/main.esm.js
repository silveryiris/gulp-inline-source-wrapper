import{inlineSource}from"inline-source";import path from"path";import through from"through2";import PluginError from"plugin-error";const PROJECT_NAME="gulp-inline-source-wrapper";function inlineSourceWrapper(r={}){const t=through.obj(async(e,o,n)=>{if(e.isNull()||e.isDirectory())return t.push(e),n();if(e.isStream())return t.emit("error",new PluginError(PROJECT_NAME,"Streaming not supported")),n();const i={...{rootpath:path.dirname(e.path),htmlpath:e.path},...r};try{const r=await inlineSource(e.contents.toString(),i);e.contents=new Buffer(r||""),t.push(e),n()}catch(r){t.emit("error",new PluginError(PROJECT_NAME,r))}});return t}export default inlineSourceWrapper;export{inlineSourceWrapper};
